<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta content="Train Map" property="og:title"/>
  <meta content="Train line map of SnackSMP" property="og:description"/>
  <link rel="icon" type="image/png" href="icon.jpg">
  <meta property="og:url" content="https://lemon4ik6484.github.io/Train-Map/"/>
  <meta property="og:image" content="https://lemon4ik6484.github.io/Train-Map/preview.png"/>
  <meta content="#fcfaf3" data-react-helmet="true" name="theme-color"/>
  <title>Train Map</title>

  <link rel="preload" href="map.svg" as="image">
  <link rel="preload" href="logo.svg" as="image">
  <link rel="preload" href="legend_up.svg" as="image">
  <link rel="preload" href="legend_bottom.svg" as="image">

  <link rel="preload" href="dark_map.svg" as="image">
  <link rel="preload" href="logo_dark.svg" as="image">
  <link rel="preload" href="legend_up_dark.svg" as="image">
  <link rel="preload" href="legend_bottom_dark.svg" as="image">

  <link rel="preload" href="sun.svg" as="image">
  <link rel="preload" href="moon.svg" as="image">
  <style>
    body {
      margin: 0;
      padding: 0;
    }
    
    #map {
      width: 100vw;
      height: 100vh;
      background-color: #fcfaf3;
      z-index: 0;
      border: #41da5b;
    }

    .logo {
      position: absolute;
      top: 0;
      left: 0;
      margin: 1%;
      max-width: 250px;
      height: auto;
    }

    .legend {
      position: fixed;
      bottom: 0;
      right: 0;
      margin: 1%;
      margin-right: 0;
      max-width: 250px;
      height: auto;
    }

    @media (max-width: 600px) {
      .logo, .legend, .theme_btn {
        max-width: 200px;
      }
    }

    @media (min-width: 601px) and (max-width: 1024px) {
      .logo, .legend, .theme_btn {
        max-width: 250px;
      }
    }

    @media (min-width: 1025px) {
      .logo, .legend, .theme_btn {
        max-width: 300px;
      }
    }

    .logo, .legend {
      z-index: 1500;
    }

    .logo {
      margin: 1%;
    }

    .legend {
      display: inline-flex;
      flex-direction: column;
      flex-wrap: nowrap;
      justify-content: flex-start;
      align-items: stretch;
      align-content: stretch;
      margin: 1%;
    }

    .legend_item {
      margin: 3%;
    }

    .LineButton {
      height: 22px;
      width: 22px;
      display: fixed;
      top: 0;
      left: 0;
    }

    #overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      z-index: 1000;
    }

    .overlay-active #overlay {
      display: block;
    }

    .A_Glow {
      box-shadow: 0 0 5px 5px #ff7575;
      border-radius: 50%;
      background-color: rgba(255, 117, 117, 0.25);
    }

    .B_Glow {
      box-shadow: 0 0 5px 5px #ff8bfa;
      border-radius: 50%;
      background-color: rgba(255, 139, 250, 0.25);
    }

    .L1_Glow {
      box-shadow: 0 0 5px 5px #58c4ff;
      border-radius: 50%;
      background-color: rgba(88, 196, 255, 0.25);
    }

    .L2_Glow {
      box-shadow: 0 0 5px 5px #ff8bfa;
      border-radius: 50%;
      background-color: rgba(255, 139, 250, 0.25);
    }

    .L6_Glow {
      box-shadow: 0 0 5px 5px #81fc95;
      border-radius: 50%;
      background-color: rgba(129, 252, 149, 0.25);
    }

    .L8_Glow {
      box-shadow: 0 0 5px 5px #8d7ee8;
      border-radius: 50%;
      background-color: rgba(141, 126, 232, 0.25);
    }

    .R12_Glow {
      box-shadow: 0 0 5px 5px #ffc52a;
      border-radius: 50%;
      background-color: rgba(255, 197, 42, 0.25);
    }

    .R13_Glow {
      box-shadow: 0 0 5px 5px #ff8bfa;
      border-radius: 50%;
      background-color: rgba(255, 139, 250, 0.25);
    }

    .R14_Glow {
      box-shadow: 0 0 5px 5px #8b7fe9;
      border-radius: 50%;
      background-color: rgba(139, 127, 233, 0.25);
    }

    .L21_Glow {
      box-shadow: 0 0 5px 5px #5f8199;
      border-radius: 50%;
      background-color: rgba(95, 129, 153, 0.25);
    }

    .L22_Glow {
      box-shadow: 0 0 5px 5px #819db2;
      border-radius: 50%;
      background-color: rgba(129, 157, 178, 0.25);
    }

    .L23_Glow {
      box-shadow: 0 0 5px 5px #5f8199;
      border-radius: 50%;
      background-color: rgba(95, 129, 153, 0.25);
    }

    #A_btn {
      position: absolute; 
      top: 19.5%; 
      left: 13.75%;
      height: 24px;
      width: 24px;
      background: none;
      border: none;
      cursor: pointer;
    }

    #B_btn {
      position: absolute; 
      top: 19.5%; 
      left: 27.75%;
      height: 24px;
      width: 24px;
      background: none;
      border: none;
      cursor: pointer;
    }

    #L1_btn {
      position: absolute; 
      top: 53.25%; 
      left: 14.25%;
      height: 20px;
      width: 20px;
      background: none;
      border: none;
      cursor: pointer;
    }

    #L2_btn {
      position: absolute; 
      top: 53.25%; 
      left: 28.75%;
      height: 20px;
      width: 20px;
      background: none;
      border: none;
      cursor: pointer;
    }

    #L6_btn {
      position: absolute; 
      top: 53.25%; 
      left: 42.5%;
      height: 20px;
      width: 20px;
      background: none;
      border: none;
      cursor: pointer;
    }

    #L8_btn {
      position: absolute; 
      top: 53.25%; 
      left: 56.5%;
      height: 20px;
      width: 20px;
      background: none;
      border: none;
      cursor: pointer;
    }

    #R12_btn {
      position: absolute; 
      top: 69.75%; 
      left: 14.75%;
      height: 20px;
      width: 20px;
      background: none;
      border: none;
      cursor: pointer;
    }

    #R13_btn {
      position: absolute; 
      top: 69.75%; 
      left: 28.5%;
      height: 20px;
      width: 20px;
      background: none;
      border: none;
      cursor: pointer;
    }

    #R14_btn {
      position: absolute; 
      top: 69.75%; 
      left: 42%;
      height: 20px;
      width: 20px;
      background: none;
      border: none;
      cursor: pointer;
    }

    #L21_btn {
      position: absolute; 
      top: 86.5%; 
      left: 14.5%;
      height: 20px;
      width: 20px;
      background: none;
      border: none;
      cursor: pointer;
    }

    #L22_btn {
      position: absolute; 
      top: 86.5%; 
      left: 28.5%;
      height: 20px;
      width: 20px;
      background: none;
      border: none;
      cursor: pointer;
    }

    #L23_btn {
      position: absolute; 
      top: 86.5%; 
      left: 42.25%;
      height: 20px;
      width: 20px;
      background: none;
      border: none;
      cursor: pointer;
    }

    .oneWay.glowing {border-radius: 50%;}

    .twoWay.glowing {border-radius: 20% 20% 20% 20% / 50% 50% 50% 50%;}

    .threeWay.glowing {border-radius: 15% 15% 15% 15% / 50% 50% 50% 50%;}

    .fourWay.glowing {border-radius: 10% 10% 10% 10% / 50% 50% 50% 50%;}

    .darkMode {
      background-color: #080e1e !important;
    }

    .theme_btn{
      position: fixed;
      top: 1%;
      right: 1%;
      z-index: 1500;
    }

    #map {
      -webkit-user-select: none;  /* Chrome, Safari, Opera */
      -moz-user-select: none;     /* Firefox */
      -ms-user-select: none;      /* Internet Explorer/Edge */
      user-select: none;          /* Non-prefixed version, currently supported by most browsers */
    }

  </style>
  <!-- Подключаем Leaflet CSS -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
  <div id="theme_button" class="theme_btn">
    <svg width="75">
      <image id="theme_img" href="./sun.svg" wigth="50%" height="50%"/>
    </svg>
  </div>
  <div id="map"></div>

  <a href="https://sites.google.com/view/sb-ctd/home" target="_blank">
    <svg class="logo ui" width="589.5" height="222">
      <image id="logo_img" href="logo.svg" width="100%" height="100%"/>
    </svg>
  </a>

  <div class="legend updateIconSizes">
    <svg class="legend_item" width="225" height="106.5">
      <image id="legend_up_img" href="legend_up.svg" width="100%" height="100%"/>
    </svg>
    <svg class="legend_item" width="223.5" height="228">
      <image id="legend_bottom_img" href="legend_bottom.svg" width="100%" height="100%"/>
    </svg>

    <button id="A_btn" onclick="toggleOverlay('A')"></button>
    <button id="B_btn" onclick="toggleOverlay('B')"></button>
    <button id="L1_btn" onclick="toggleOverlay('L1')"></button>
    <button id="L2_btn" onclick="toggleOverlay('L2')"></button>
    <button id="L6_btn" onclick="toggleOverlay('L6')"></button>
    <button id="L8_btn" onclick="toggleOverlay('L8')"></button>
    <button id="R12_btn" onclick="toggleOverlay('R12')"></button>
    <button id="R13_btn" onclick="toggleOverlay('R13')"></button>
    <button id="R14_btn" onclick="toggleOverlay('R14')"></button>
    <button id="L21_btn" onclick="toggleOverlay('L21')"></button>
    <button id="L22_btn" onclick="toggleOverlay('L22')"></button>
    <button id="L23_btn" onclick="toggleOverlay('L23')"></button>
  </div>

  <div id="overlay" class="first_time" onclick="toggleOverlay()"></div>

  <script>
    line_glows = ["A_Glow", "B_Glow", "L1_Glow", "L2_Glow", "L6_Glow", "L8_Glow", "R12_Glow", "R13_Glow", "R14_Glow", "L21_Glow", "L22_Glow", "L23_Glow"];
    imageBounds = [[0, 0], [1000, 1000]];
    const themeBtn = document.getElementById("theme_button");
    const darkModeKey = "TrainMapDarkMode";

    const enableDarkMode = () => {
      document.body.classList.add("darkMode");
      document.getElementById("map").classList.add("darkMode");
      localStorage.setItem(darkModeKey, "true");

      map.removeLayer(currentOverlay);
      currentOverlay = L.imageOverlay("./dark_map.svg", imageBounds).addTo(map);

      document.getElementById("logo_img").setAttribute('href', "./logo_dark.svg");
      document.getElementById("legend_bottom_img").setAttribute('href', "./legend_bottom_dark.svg");
      document.getElementById("legend_up_img").setAttribute('href', "./legend_up_dark.svg");
      document.getElementById("theme_img").setAttribute('href', "./moon.svg");
    };

    const disableDarkMode = () => {
      document.body.classList.remove("darkMode");
      document.getElementById("map").classList.remove("darkMode");
      localStorage.setItem(darkModeKey, "false");

      map.removeLayer(currentOverlay);
      currentOverlay = L.imageOverlay("./map.svg", imageBounds).addTo(map);

      document.getElementById("logo_img").setAttribute('href', "./logo.svg");
      document.getElementById("legend_bottom_img").setAttribute('href', "./legend_bottom.svg");
      document.getElementById("legend_up_img").setAttribute('href', "./legend_up.svg");
      document.getElementById("theme_img").setAttribute('href', "./sun.svg");
    };

    themeBtn.onclick = () => {
      themeBtn.classList.toggle("moon");
      if (themeBtn.classList.contains("moon")) {
        enableDarkMode();
      } else {
        disableDarkMode();
      }
    };

    function add_glow(line) {
      var glowClass = line + '_Glow';

      if (line_glows.includes(glowClass)) {
        var elements = document.querySelectorAll('.icon.' + line);

        elements.forEach(function(element) {
          element.classList.add(glowClass);
          element.classList.add('glowing');
        });
      }
    }


    function remove_glow() {
      var stations = document.querySelectorAll('.icon');
      stations.forEach(function(station){
        for (let line of line_glows) {
          if (station.classList.contains(line)) {
            station.classList.remove(line);
            station.classList.remove('glowing');
          }
        }
      });
    }

    function toggleOverlay(line) {
      remove_glow();
      var overlay = document.getElementById('overlay');
      var active = overlay.classList.contains('overlay-active');
      
      if (overlay.classList.contains(line)) {
        var needToToggle = true;
      } else if (overlay.classList.contains('first_time')) {
        var needToToggle = true;
      } else if (!overlay.classList.contains('overlay-active')) {
        var needToToggle = true;
      } else {
        var needToToggle = false;
      }

      var classesToKeep = active ? ['overlay-active'] : [];
      
      overlay.className = classesToKeep.join(' ');

      if (needToToggle) {
        overlay.classList.toggle('overlay-active');
      }

      if (line === 'L1') {
        overlay.classList.toggle('L1');
      } else if (line === 'L2') {
        overlay.classList.toggle('L2');
      } else if (line === 'L6') {
        overlay.classList.toggle('L6');
      } else if (line === 'L8') {
        overlay.classList.toggle('L8');
      } else if (line === 'R12') {
        overlay.classList.toggle('R12');
      } else if (line === 'R13') {
        overlay.classList.toggle('R13');
      } else if (line === 'R14') {
        overlay.classList.toggle('R14');
      } else if (line === 'L21') {
        overlay.classList.toggle('L21');
      } else if (line === 'L22') {
        overlay.classList.toggle('L22');
      } else if (line === 'L23') {
        overlay.classList.toggle('L23');
      } else if (line === 'A') {
        overlay.classList.toggle('A');
      } else if (line === 'B') {
        overlay.classList.toggle('B');
      }

      var map = document.getElementById('map');
      if (document.getElementById('overlay').classList.contains('overlay-active')) {
        add_glow(line);
      } else {
        remove_glow();
      }
    }
    // Загружаем Leaflet JS после того, как документ полностью загрузится
    window.onload = function () {
      // Создаем карту с указанным фоном и изображением
      map = L.map('map', {
        crs: L.CRS.Simple,
        minZoom: -1, // Установите минимальное значение зума, чтобы изображение занимало весь контейнер
        maxZoom: 2 // Устанавливаем максимальное значение зума
      });

      // Удаляем ненужные элементы управления
      map.removeControl(map.zoomControl);
      //map.removeControl(map.attributionControl);

      // Добавляем изображение
      const isDarkModeEnabled = localStorage.getItem(darkModeKey) === "true";
      if (isDarkModeEnabled) {
        themeBtn.classList.add("moon");
        currentOverlay = L.imageOverlay('./dark_map.svg', imageBounds).addTo(map);
        enableDarkMode();
      } else {
        themeBtn.classList.add("sun");
        currentOverlay = L.imageOverlay('./map.svg', imageBounds).addTo(map);
        disableDarkMode();
      }

      var originalIconSize = 50; // Оригинальный размер иконки

      function createOneIcon(size) {
        return L.icon({
          iconUrl: 'empty.png',
          iconSize: [size, size],
          className: 'icon'
        });
      };
      function createTwoIcon(size) {
        return L.icon({
          iconUrl: 'empty.png',
          iconSize: [size * 2.75, size],
          className: 'icon'
        });
      };
      function createThreeIcon(size) {
        return L.icon({
          iconUrl: 'empty.png',
          iconSize: [size * 4, size],
          className: 'icon'
        });
      };
      function createFourIcon(size) {
        return L.icon({
          iconUrl: 'empty.png',
          iconSize: [size * 4.9, size],
          className: 'icon'
        });
      };

      riverantMarker = L.marker([537, 545], {icon: createThreeIcon(originalIconSize)}).addTo(map)
        .bindPopup('Riverant')
        .openPopup();
      timberlandMarker = L.marker([503, 405], {icon: createOneIcon(originalIconSize)}).addTo(map)
        .bindPopup('Timberland')
        .openPopup();
      centralMarker = L.marker([586.75, 670], {icon: createFourIcon(originalIconSize)}).addTo(map)
        .bindPopup('Central')
        .openPopup();
      wompwompMarker = L.marker([561.75, 611.5], {icon: createTwoIcon(originalIconSize)}).addTo(map)
        .bindPopup('Womp Womp')
        .openPopup();
      andesworthMarker = L.marker([410, 537], {icon: createOneIcon(originalIconSize)}).addTo(map)
        .bindPopup('Port Andesworth')
        .openPopup();
      krunkeriaMarker = L.marker([637, 868], {icon: createOneIcon(originalIconSize)}).addTo(map)
        .bindPopup('Krunkeria')
        .openPopup();
      cherryvilleMarker = L.marker([700, 712], {icon: createOneIcon(originalIconSize)}).addTo(map)
        .bindPopup('Cherryville')
        .openPopup();
      blossomingValleyMarker = L.marker([752, 703], {icon: createTwoIcon(originalIconSize)}).addTo(map)
        .bindPopup('Blossoming Valley')
        .openPopup();
      newportMarker = L.marker([803.35, 678.37], {icon: createOneIcon(originalIconSize)}).addTo(map)
        .bindPopup('Newport')
        .openPopup();
      lyciaBridgeMarker = L.marker([886.75, 637], {icon: createFourIcon(originalIconSize)}).addTo(map)
        .bindPopup('Lycia Bridge')
        .openPopup();
      capitalisoriaMarker = L.marker([920, 586.75], {icon: createOneIcon(originalIconSize)}).addTo(map)
        .bindPopup('Capitalisoria')
        .openPopup();
      rublenikaMarker = L.marker([953.3, 768], {icon: createOneIcon(originalIconSize)}).addTo(map)
        .bindPopup('Rublenika')
        .openPopup();
      refineryMarker = L.marker([770, 524.85], {icon: createOneIcon(originalIconSize)}).addTo(map)
        .bindPopup('Refinery')
        .openPopup();
      fortBoreasMarker = L.marker([770, 381.7], {icon: createOneIcon(originalIconSize)}).addTo(map)
        .bindPopup('Fort Boreas')
        .openPopup();
      hammeringtonMarker = L.marker([703.5, 381.7], {icon: createOneIcon(originalIconSize)}).addTo(map)
        .bindPopup('Hammerington')
        .openPopup();
      middleseaBeachMarker = L.marker([419.4, 260.6], {icon: createTwoIcon(originalIconSize)}).addTo(map)
        .bindPopup('Middlesea Beach')
        .openPopup();
      jungletownIndustrialMarker = L.marker([361.4, 260.6], {icon: createTwoIcon(originalIconSize)}).addTo(map)
        .bindPopup('Jungletown Industrial')
        .openPopup();
      jungletownTempleMarker = L.marker([303.25, 276.25], {icon: createFourIcon(originalIconSize)}).addTo(map)
        .bindPopup('Jungletown Temple')
        .openPopup();
      communistaMarker = L.marker([270.5, 437], {icon: createTwoIcon(originalIconSize)}).addTo(map)
        .bindPopup('Communista')
        .openPopup();
      grimsbyPeaksMarker = L.marker([172, 293.5], {icon: createTwoIcon(originalIconSize)}).addTo(map)
        .bindPopup('Greamsby Peaks')
        .openPopup();
      oakridgeMarker = L.marker([111.5, 357], {icon: createOneIcon(originalIconSize)}).addTo(map)
        .bindPopup('Oakridge')
        .openPopup();
      CheeselandMarker = L.marker([111.5, 413.5], {icon: createOneIcon(originalIconSize)}).addTo(map)
        .bindPopup('Cheeseland')
        .openPopup();
      staraWiesMarker = L.marker([111.5, 462], {icon: createOneIcon(originalIconSize)}).addTo(map)
        .bindPopup('Stara Wies')
        .openPopup();
      newIndustriaMarker = L.marker([128, 225], {icon: createOneIcon(originalIconSize)}).addTo(map)
        .bindPopup('New Industria')
        .openPopup();
      birchlandMarker = L.marker([453, 443], {icon: createOneIcon(originalIconSize)}).addTo(map)
        .bindPopup('Birchland')
        .openPopup();
      southernCrossMarker = L.marker([453, 332], {icon: createOneIcon(originalIconSize)}).addTo(map)
        .bindPopup('Southern Cross')
        .openPopup();
      rybnikMarker = L.marker([212, 228], {icon: createOneIcon(originalIconSize)}).addTo(map)
        .bindPopup('Rybník')
        .openPopup();
      endPortalMarker = L.marker([212, 172], {icon: createOneIcon(originalIconSize)}).addTo(map)
        .bindPopup('End Portal')
        .openPopup();

      // Устанавливаем область видимости карты
      map.fitBounds(imageBounds);

      // Отключаем двойное нажатие для зума
      map.doubleClickZoom.disable();

      function updateIconSizes() {
        var currentZoom = map.getZoom();
        var elements = document.querySelectorAll('.icon');
        var newOneSize;
        var newOneSizeEnd;
        var newTwoSize;
        var newThreeSize;
        var newFourSize;
        var newTwoSizeSmall;
        elements.forEach(function(element) {
          element.style.display = '';
        });

        if (currentZoom === 3) {
          newOneSize = 120
          newOneSizeEnd = 150
          newTwoSize = 109
          newTwoSizeSmall = 100
          newThreeSize = 120
          newFourSize = 120
        } else if (currentZoom === 2) { // limit
          newOneSize = 53
          newOneSizeEnd = 60
          newTwoSize = 49
          newTwoSizeSmall = 40
          newThreeSize = 50
          newFourSize = 54
        } else if (currentZoom === 1) {
          newOneSize = 26.5
          newOneSizeEnd = 33
          newTwoSize = 25
          newTwoSizeSmall = 20
          newThreeSize = 25
          newFourSize = 27
        } else if (currentZoom === 0) {
          newOneSize = 12
          newOneSizeEnd = 15
          newTwoSize = 12
          newTwoSizeSmall = 10
          newThreeSize = 12
          newFourSize = 14
        } else if (currentZoom === -1) { //limit
          newOneSize = 6.5
          newOneSizeEnd = 7
          newTwoSize = 6.5
          newTwoSizeSmall = 5
          newThreeSize = 6.5
          newFourSize = 6.5
        } else if (currentZoom === -2) {
          newOneSize = 4
          newOneSizeEnd = 5
          newTwoSize = 3.5
          newThreeSize = 4
          newFourSize = 3.7
        } 

        riverantMarker.setIcon(createThreeIcon(newThreeSize));
        timberlandMarker.setIcon(createOneIcon(newOneSize));
        centralMarker.setIcon(createFourIcon(newFourSize));
        wompwompMarker.setIcon(createOneIcon(newOneSize));
        andesworthMarker.setIcon(createTwoIcon(newTwoSize));
        krunkeriaMarker.setIcon(createOneIcon(newOneSizeEnd));
        cherryvilleMarker.setIcon(createOneIcon(newOneSize));
        blossomingValleyMarker.setIcon(createTwoIcon(newTwoSize));
        newportMarker.setIcon(createOneIcon(newTwoSize));
        lyciaBridgeMarker.setIcon(createFourIcon(newFourSize));
        capitalisoriaMarker.setIcon(createOneIcon(newOneSizeEnd));
        rublenikaMarker.setIcon(createOneIcon(newOneSizeEnd));
        refineryMarker.setIcon(createOneIcon(newOneSize));
        fortBoreasMarker.setIcon(createOneIcon(newOneSize));
        hammeringtonMarker.setIcon(createOneIcon(newOneSize));
        middleseaBeachMarker.setIcon(createTwoIcon(newTwoSizeSmall));
        jungletownIndustrialMarker.setIcon(createTwoIcon(newTwoSizeSmall));
        jungletownTempleMarker.setIcon(createFourIcon(newFourSize));
        communistaMarker.setIcon(createTwoIcon(newTwoSize));
        grimsbyPeaksMarker.setIcon(createTwoIcon(newTwoSize));
        oakridgeMarker.setIcon(createOneIcon(newOneSize));
        CheeselandMarker.setIcon(createOneIcon(newOneSize));
        staraWiesMarker.setIcon(createOneIcon(newOneSizeEnd));
        newIndustriaMarker.setIcon(createOneIcon(newOneSizeEnd));
        birchlandMarker.setIcon(createOneIcon(newOneSize));
        southernCrossMarker.setIcon(createOneIcon(newOneSize));
        rybnikMarker.setIcon(createOneIcon(newOneSize));
        endPortalMarker.setIcon(createOneIcon(newOneSizeEnd));
        
        L.DomUtil.addClass(riverantMarker._icon, 'threeWay L1 L6 L23');
        L.DomUtil.addClass(timberlandMarker._icon, 'oneWay L6');
        L.DomUtil.addClass(centralMarker._icon, 'fourWay A B L1 L2');
        L.DomUtil.addClass(wompwompMarker._icon, 'oneWay L1');
        L.DomUtil.addClass(andesworthMarker._icon, 'twoWay L23 L8');
        L.DomUtil.addClass(krunkeriaMarker._icon, 'oneWay B');
        L.DomUtil.addClass(cherryvilleMarker._icon, 'oneWay L2');
        L.DomUtil.addClass(blossomingValleyMarker._icon, 'twoWay L1 L2');
        L.DomUtil.addClass(newportMarker._icon, 'oneWay L1');
        L.DomUtil.addClass(lyciaBridgeMarker._icon, 'fourWay A L1 L21 L22');
        L.DomUtil.addClass(capitalisoriaMarker._icon, 'oneWay L21');
        L.DomUtil.addClass(rublenikaMarker._icon, 'oneWay L22');
        L.DomUtil.addClass(refineryMarker._icon, 'oneWay L2');
        L.DomUtil.addClass(fortBoreasMarker._icon, 'oneWay L2');
        L.DomUtil.addClass(hammeringtonMarker._icon, 'oneWay L2');
        L.DomUtil.addClass(middleseaBeachMarker._icon, 'twoWay L6 L8');
        L.DomUtil.addClass(jungletownIndustrialMarker._icon, 'twoWay L6 L8');
        L.DomUtil.addClass(jungletownTempleMarker._icon, 'fourWay L6 R13 R14 L8');
        L.DomUtil.addClass(communistaMarker._icon, 'twoWay R12 R13');
        L.DomUtil.addClass(grimsbyPeaksMarker._icon, 'twoWay R12 R14');
        L.DomUtil.addClass(oakridgeMarker._icon, 'oneWay R14');
        L.DomUtil.addClass(CheeselandMarker._icon, 'oneWay R14');
        L.DomUtil.addClass(staraWiesMarker._icon, 'oneWay R14');
        L.DomUtil.addClass(newIndustriaMarker._icon, 'oneWay R12');
        L.DomUtil.addClass(birchlandMarker._icon, 'oneWay L8');
        L.DomUtil.addClass(southernCrossMarker._icon, 'oneWay L8');
        L.DomUtil.addClass(rybnikMarker._icon, 'oneWay L8');
        L.DomUtil.addClass(endPortalMarker._icon, 'oneWay L8');

        var classes = document.getElementById('overlay').classList;
        var lineToAdd = classes.length > 1 ? classes[1] : null;
        
        if (lineToAdd) {
          add_glow(lineToAdd);
        }
      }      

      // Обработчик события "zoomend" для изменения размера значков при зуме
      map.on('zoomend', updateIconSizes);

      map.on('zoomstart', function(){
        var elements = document.querySelectorAll('.icon');
        elements.forEach(function(element) {
          element.style.display = 'none';
        });
      });

      // Обновляем размер значков при загрузке страницы
      updateIconSizes();
    };
  </script>

  <!-- Подключаем Leaflet JS -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</body>
</html>